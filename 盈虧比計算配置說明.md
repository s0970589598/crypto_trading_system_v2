# 盈虧比計算配置說明

## 🎯 為什麼是 15 根 K 線？

### 默認設置的理由

**15 根 15 分鐘 K 線 = 3.75 小時**

這是基於以下考慮：

1. **涵蓋一個交易時段**
   - 約半個交易日的時間
   - 足以看到最近的市場結構
   - 不會太短（避免噪音干擾）
   - 不會太長（避免過時信息）

2. **符合短線交易特性**
   - 適合持倉幾小時到一天的交易
   - 止損基於最近的市場波動
   - 平衡了靈敏度和穩定性

3. **技術分析慣例**
   - 專業交易者通常看 10-30 根 K 線
   - 15 根是一個經驗值的折中選擇

## 🔧 如何調整？

在 `web_dashboard_v2.py` 中找到這一行：

```python
LOOKBACK_CANDLES = 15  # 往前看幾根 K 線（可調整：5-30）
```

根據你的交易風格修改這個數字。

## 📊 不同交易風格的建議

### 1. 超短線（剝頭皮）

```python
LOOKBACK_CANDLES = 5-8
```

- **時間範圍**：1.25-2 小時
- **持倉時間**：幾分鐘到 1 小時
- **特點**：
  - 快進快出
  - 止損要緊
  - 對噪音敏感
- **適合**：高頻交易者

### 2. 短線（日內交易）← 系統默認

```python
LOOKBACK_CANDLES = 10-15
```

- **時間範圍**：2.5-3.75 小時
- **持倉時間**：幾小時到當天
- **特點**：
  - 當天平倉
  - 止損適中
  - 平衡靈敏度和穩定性
- **適合**：大多數日內交易者

### 3. 波段（持倉數天）

```python
LOOKBACK_CANDLES = 15-20
```

- **時間範圍**：3.75-5 小時
- **持倉時間**：1-5 天
- **特點**：
  - 跨日持倉
  - 止損較寬
  - 更穩定的市場結構
- **適合**：波段交易者

### 4. 趨勢（持倉數週）

```python
LOOKBACK_CANDLES = 20-30
```

- **時間範圍**：5-7.5 小時
- **持倉時間**：數週到數月
- **特點**：
  - 長期持倉
  - 止損很寬
  - 忽略短期波動
- **適合**：趨勢跟隨者

## 📈 如何選擇合適的數值？

### 方法 1：根據平均持倉時間

查看你的交易記錄，計算平均持倉時間：

| 平均持倉時間 | 建議 K 線數 | 時間範圍 |
|------------|-----------|---------|
| < 2 小時 | 5-8 | 1.25-2 小時 |
| 2-6 小時 | 10-15 | 2.5-3.75 小時 |
| 6-24 小時 | 15-20 | 3.75-5 小時 |
| > 24 小時 | 20-30 | 5-7.5 小時 |

**公式**：K 線數 ≈ 平均持倉時間 / 15 分鐘

### 方法 2：根據止損習慣

如果你習慣：
- **緊止損**（< 1% 風險）→ 用較少 K 線（5-10）
- **中等止損**（1-2% 風險）→ 用中等 K 線（10-15）
- **寬止損**（> 2% 風險）→ 用較多 K 線（15-30）

### 方法 3：回測驗證

1. 嘗試不同的 K 線數（5, 10, 15, 20, 30）
2. 重新評分你的歷史交易
3. 比較哪個設置的盈虧比最接近你的實際交易
4. 選擇最符合你交易風格的數值

## ⚖️ 權衡考慮

### K 線數太少（< 10）

**優點**：
- 止損更緊
- 風險更小
- 適合高勝率策略

**缺點**：
- 容易被正常波動掃出
- 盈虧比可能偏高（不真實）
- 不適合波動大的市場

### K 線數適中（10-15）

**優點**：
- 平衡風險和穩定性
- 適合大多數交易風格
- 不容易被掃出

**缺點**：
- 可能不完全符合個人風格
- 需要根據市場調整

### K 線數太多（> 20）

**優點**：
- 止損很穩定
- 不會被短期波動影響
- 適合趨勢交易

**缺點**：
- 止損太寬，風險大
- 盈虧比可能偏低
- 不適合短線交易

## 🎨 實際示例

### 示例 1：超短線交易者

```
交易風格：剝頭皮
平均持倉：30 分鐘
建議設置：LOOKBACK_CANDLES = 5

計算：
- 5 根 × 15 分鐘 = 75 分鐘 = 1.25 小時
- 涵蓋最近 1.25 小時的波動
- 止損緊，適合快進快出
```

### 示例 2：日內交易者（默認）

```
交易風格：短線
平均持倉：4 小時
建議設置：LOOKBACK_CANDLES = 15

計算：
- 15 根 × 15 分鐘 = 225 分鐘 = 3.75 小時
- 涵蓋最近 3.75 小時的波動
- 止損適中，平衡風險和穩定性
```

### 示例 3：波段交易者

```
交易風格：波段
平均持倉：2 天
建議設置：LOOKBACK_CANDLES = 20

計算：
- 20 根 × 15 分鐘 = 300 分鐘 = 5 小時
- 涵蓋最近 5 小時的波動
- 止損較寬，適合跨日持倉
```

## 🔄 動態調整建議

### 根據市場波動調整

**高波動市場**（ATR > 3%）：
- 增加 K 線數（+5）
- 避免被正常波動掃出

**低波動市場**（ATR < 1.5%）：
- 減少 K 線數（-5）
- 止損可以更緊

### 根據交易結果調整

如果發現：
- **經常被止損掃出** → 增加 K 線數
- **止損太寬，虧損太大** → 減少 K 線數
- **盈虧比普遍 < 1** → 檢查進場點，不是 K 線數的問題

## 💡 專業建議

### 1. 從默認值開始

如果不確定，先用默認的 15 根：
```python
LOOKBACK_CANDLES = 15
```

### 2. 觀察一段時間

評分 20-30 筆交易後，觀察：
- 估算的止損位是否合理？
- 盈虧比是否符合實際？
- 是否經常被掃出？

### 3. 逐步調整

每次調整 ±5 根：
- 如果止損太緊 → 增加到 20
- 如果止損太寬 → 減少到 10

### 4. 記錄和比較

記錄不同設置下的：
- 平均盈虧比
- 勝率
- 平均風險
- 最大虧損

選擇最符合你交易風格的設置。

## 📚 延伸閱讀

- 查看你的交易統計（平均持倉時間）
- 分析你的止損習慣
- 研究不同時區的市場結構
- 學習專業交易者的止損設置方法

## ⚠️ 重要提醒

**這個參數沒有"最佳值"**，只有"最適合你的值"！

- 每個交易者的風格不同
- 每個市場的特性不同
- 每個時期的波動不同

**持續優化，找到最適合自己的設置！**
